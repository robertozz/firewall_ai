# ğŸ”¥ firewall_ai â€“ Gestione dinamica di nftables via Docker

Automatizza la configurazione del firewall con `nftables` leggendo da un file YAML e notificando via Telegram solo eventi significativi (errori, aggiunte, rimozioni). Pensato per ambienti self-hosted con Docker.

---

## ğŸš€ Avvio rapido

```bash
git clone https://github.com/tuo-utente/firewall_ai.git
cd firewall_ai
sudo docker compose up -d --build

ğŸ› ï¸ Requisiti
Docker (non in modalitÃ  rootless)

network_mode: host e cap_add: NET_ADMIN abilitati nel docker-compose.yml

nftables installato sullâ€™host

Bot Telegram configurato in config/telegram.yaml

ğŸ“¦ Struttura

firewall_ai/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ services.yaml         # Elenco dei servizi da autorizzare
â”œâ”€â”€ logs/
â”‚   â””â”€â”€ firewall.log.json     # Log strutturati
â”œâ”€â”€ rules/
â”‚   â””â”€â”€ firewall.rules        # Dump regole nftables
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ telegram_utils.py     # Notifiche Telegram
â”œâ”€â”€ firewall_ai.py            # Script principale
â””â”€â”€ docker-compose.yml        # Configurazione container

âš™ï¸ Comandi utili
Azione	Comando
Avvia container		sudo docker compose up -d --build
Riavvia container	sudo docker compose restart firewall_ai
Verifica regole		sudo nft list ruleset
Verifica log		sudo docker logs -f firewall_ai
Esegui manualmente	sudo python3 firewall_ai.py

Nel Makefile trovi
# Makefile per gestione agente firewall AI

run:
        @echo "â–¶ï¸ Avvio agente firewall..."
        python3 firewall_ai.py

test-telegram:
        @echo "ğŸ“¡ Test notifica Telegram..."
        python3 test_notify.py --html

html:
        @echo "ğŸ§¾ Conversione log in HTML..."
        python3 utils/telegram_utils.py --html

clean:
        @echo "ğŸ§¹ Pulizia log e HTML..."
        rm -f logs/firewall.log logs/firewall.html

ğŸ“¬ Notifiche Telegram
Solo per errori, aggiunte o rimozioni

Raggruppate ogni 5 minuti

Formattate in MarkdownV2

ğŸ” Persistenza regole
Per mantenere le regole dopo reboot dellâ€™host:

bash
sudo cp rules/firewall.rules /etc/nftables.conf
sudo systemctl enable nftables
